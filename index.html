<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>小尾巴的七夕礼物 💝</title>
<style>
  body {
    font-family: "Helvetica Neue", Arial, sans-serif;
    background: linear-gradient(135deg, #ffe6eb, #fff0f5);
    margin: 0; padding: 0;
  }
  .card {
    max-width: 760px;
    margin: 40px auto;
    padding: 22px;
    background: #fff;
    border-radius: 18px;
    box-shadow: 0 8px 24px rgba(255, 120, 160, 0.25);
    position: relative;
    text-align: center;
  }
  h1 {
    margin: 0 0 16px;
    font-size: 28px;
    color: #e25590;
  }
  p {
    color: #555;
    line-height: 1.6;
  }
  .btn {
    display: inline-block;
    margin-top: 18px;
    padding: 12px 20px;
    border-radius: 10px;
    background: #ff7aa2;
    color: #fff;
    border: none;
    cursor: pointer;
    transition: background 0.2s, transform 0.2s;
    font-size: 16px;
  }
  .btn:hover {
    background: #ff5a8c;
    transform: scale(1.05);
  }
  .btn.secondary {
    background: #ffe4ec;
    color: #d6336c;
    border: 1px solid #f9b5d1;
  }
  .hearts {
    font-size: 28px;
    animation: float 3s infinite;
    margin: 12px 0;
  }
  @keyframes float {
    0% { transform: translateY(0); opacity: 1; }
    50% { transform: translateY(-15px); opacity: 0.7; }
    100% { transform: translateY(-30px); opacity: 0; }
  }
  .music-control {
    margin-top: 16px;
  }
  .hidden { display: none; }
  footer { margin-top: 18px; font-size: 13px; color: #888; text-align: center; }

  /* 输入区域容器 */
  .input-area {
    margin-top: 28px; /* 原本16px + 12px额外间距 */
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }
  /* 输入框样式 */
  #answerInput {
    width: 80%;
    max-width: 360px;
    padding: 12px;
    border: 2px solid #ffd6e0;
    border-radius: 12px;
    font-size: 16px;
    text-align: center;
    outline: none;
    transition: border 0.2s, box-shadow 0.2s;
  }
  #answerInput:focus {
    border-color: #ff7aa2;
    box-shadow: 0 0 6px rgba(255, 122, 162, 0.4);
  }
  /* 抖动动画 */
  @keyframes shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(-6px); }
    50% { transform: translateX(6px); }
    75% { transform: translateX(-6px); }
    100% { transform: translateX(0); }
  }
  .shake {
    animation: shake 0.4s;
  }

  /* 按钮行 */
  .btn-row {
    display: flex;
    gap: 10px;
    justify-content: center;
  }
</style>
</head>
<body>
  <!-- 开场页面 -->
  <div id="intro" class="card">
    <div class="hearts">💖✨💝</div>
    <h1>Zyy 你好！我是你的七夕礼物！</h1>
    <p id="introText">
      欢迎来到给小尾巴准备的线上解谜游戏-七夕特供版 💕<br>
      聪明机灵的你将会在一个又一个的问题中寻找答案 💌<br/>
      每一道题目，都是我们故事的一部分 ✨<br/>
      希望你能带着笑容，一步步走向最终的胜利，获得活动纪念品嗷! 🎁 <br>
      From  爱你的男朋友 gwlj
    </p>
    <div class="music-control">
      <button id="musicBtn" class="btn secondary">播放音乐 🎶</button>
    </div>
    <button id="startBtn" class="btn">开始冒险 ➡️</button>
  </div>

  <!-- 游戏页面 -->
  <div id="gameCard" class="card hidden">
    <h1>七夕解谜小冒险</h1>
    <div id="game">
      <div class="prompt" id="promptTxt"></div>
      <div class="input-area">
        <input id="answerInput" type="text" placeholder="输入答案..." autocomplete="off" />
        <div class="btn-row">
          <button id="submitBtn" class="btn">提交答案</button>
          <button id="hintBtn" class="btn secondary">小提示 💌</button>
          <button id="musicBtnGame" class="btn secondary">暂停音乐 ⏸️</button>
        </div>
      </div>
      <div id="hintBox" class="hidden" style="margin-top:12px; padding:10px; background:#fff8f9; border-left:4px solid #ffb3c1; border-radius:6px;"></div>
      <div id="message" class="hidden" style="margin-top:12px; padding:10px; border-radius:6px;"></div>
      <div id="nextArea" style="margin-top:12px;"></div>
      <div id="progress" style="margin-top:10px; font-size:13px; color:#888;"></div>
    </div>
    <footer>Happy 七夕 ❤️ 爱在解谜的每一步</footer>
  </div>

  <!-- 背景音乐 -->
  <audio id="bgm" loop>
    <source src="https://ri-sycdn.kuwo.cn/16cac2c4564e23cb5fbe28ba91ce40b6/68b00647/resource/n3/58/86/1033143570.mp3" type="audio/mpeg">
  </audio>

<script>
const nodes = [
  {
    id: 1,
    prompt: "第一关 💕 \n 那里是我们初次相识的地方，是我们的第一个好友关系。\n 从普通好友开始，你就这么在我的好友列表里待了好多年。\n 你会打趣的把英文念成拼音来称呼我，还经常给我乱起名字。 \n 渐渐的，普通好友也升级成了亲密好友 \n（密码是 4 位数字）",
    answer: "5569",
    hint: "第一题的提示直接送给你！是在#后面的数字哦",
    successText: "太棒了！💖 继续前往下一关，更多的回忆在等你～"
  },
  {
    id: 2,
    prompt: "第二关 🌙 \n 渐渐的我们的关系不止于战网，还在那里有了自己的聊天室，这天就聊不完啦。细心的你是否发现，跟你聊天的人，不太一样了呢? （密码是 3 位数字）",
    answer: "520",
    hint: "第二关的提示需要说出一个你喜欢我的特质才可以获得哦！",
    successText: "好聪明爱你哟！💌 继续前进吧。"
  },

    {
    id: 3,
    prompt: "第三关 ✉️ \n 除了聊天，我们做的最多的事情就是一起玩各种各样的游戏啦，打心底里因为有一个你这样的游戏搭子而感到开心，更开心的是这个人还是我女朋友！\n  很喜欢跟你玩游戏，每个游戏都显得超好玩 \n 我们的头像还是情侣的多配呀 （密码 7 个汉字 没有空格）。",
    answer: "一只猫到此一游",
    hint: "Steam 最近有没有奇怪的信息？",
    successText: "恭喜！我要做你最好的游戏搭子！💪"
  },
    {
    id: 4,
    prompt: "第四关 🎮 \n 还记得我们玩过什么游戏吗？（密码是 4 个颜色组成的 4 个汉字）\n  1.女童常伴少东家 \n 2. 案桌横放三寿司 \n 3. 遗忘之城守夜长 \n 4. 失踪山谷厕纸凉 ",
    answer: "红绿金蓝",
    hint: "第四关的提示需要你语音叫我一声好听的来换取哦！",
    successText: "记忆力好棒！我们以后还有会有更多美好的回忆嗷！恭喜过关！"
  },
    {
    id: 5,
    prompt: "第五关 🐱 \n 除了 Steam，在其他游戏里也有我们亲密的痕迹！俗话说 ：\n 峡谷夜深两人行，\n软毛盾影伤痕明。\n屏前回首映星光，\n数字轻语藏秘密。\n指尖微动击斩敌，\n战绩之中寻踪迹。\n输出高低心中记，\n一览数值解谜题。\n （密码是一个 8 位数字）",
    answer: "6590",
    hint: "第五关的提示需要你提供一张有你的照片来换取哦！",
    successText: "恭喜过关小猫咪！离胜利还差两步啦！"
  },
    {
    id: 6,
    prompt: "第六关 ⌛️ \n 除了游戏微信steam战网这种常见的沟通，我们也另辟蹊径的开创了飞书情侣这一新赛道。\n 感谢宝宝在我不在的时候，还愿意跟我聊天！ \n 那么是从什么时候开始的呢？（密码是一个8位数字））",
    answer: "07120336",
    hint: "相信自己你能找到！有时候我做好准备了，就算做开始哦！",
    successText: "真棒！聪明的你又做到啦，马上就要最有一个问题咯，解密之旅要到尾声了呢"
  },
  {
    id: 7,
    prompt: "关底boss 🍎 \n 以始为终，以终为始，希望我们能一直好好的！去我们去过的地方，看我们看过的风景，找一个看起来奇怪的人，问问他叫什么 ",
    answer: "0905",
    hint: "相识的世界，想知的世界，然而相恋了，才带你去看的那一颗苹果",
    successText: "恭喜通关！🎉 七夕快乐，我的小宝贝❤️ 礼物在等你 👉 <strong>https://bytedance.sg.larkoffice.com/docx/RdmvdPeepoaxWjx2JbJlGo02gee</strong>"
  }
];

let currentNodeId = parseInt(localStorage.getItem('puzzle_current_node') || '1', 10);
const el = {
  intro: document.getElementById('intro'),
  startBtn: document.getElementById('startBtn'),
  gameCard: document.getElementById('gameCard'),
  promptTxt: document.getElementById('promptTxt'),
  answerInput: document.getElementById('answerInput'),
  submitBtn: document.getElementById('submitBtn'),
  hintBtn: document.getElementById('hintBtn'),
  hintBox: document.getElementById('hintBox'),
  message: document.getElementById('message'),
  nextArea: document.getElementById('nextArea'),
  progress: document.getElementById('progress'),
  musicBtn: document.getElementById('musicBtn'),
  musicBtnGame: document.getElementById('musicBtnGame'),
  bgm: document.getElementById('bgm')
};

function findNode(id){ return nodes.find(n => n.id === id); }
function renderProgress(){ el.progress.textContent = `进度：第 ${currentNodeId} / ${nodes.length} 步`; }

function loadNode(id){
  const node = findNode(id);
  if(!node) return;
  currentNodeId = node.id;
  localStorage.setItem('puzzle_current_node', String(currentNodeId));
  el.promptTxt.innerHTML = node.prompt.replace(/\n/g, "<br/>");
  el.hintBox.classList.add('hidden');
  el.hintBox.innerText = node.hint;
  el.message.classList.add('hidden');
  el.answerInput.value = "";
  el.answerInput.focus();
  el.nextArea.innerHTML = "";
  renderProgress();
}

function checkAnswer(){
  const node = findNode(currentNodeId);
  const raw = el.answerInput.value.trim();
  if(!raw){ showMessage('请输入答案再提交哦～','error'); return; }
  const input = raw.toUpperCase();
  if(input === node.answer.toUpperCase()){
    showMessage(node.successText,'success');
    const nextNode = findNode(currentNodeId + 1);
    if(nextNode){
      const btn = document.createElement('button');
      btn.className = 'btn';
      btn.innerText = '进入下一关 ➡️';
      btn.onclick = () => loadNode(nextNode.id);
      el.nextArea.appendChild(btn);
    } else {
      localStorage.setItem('puzzle_finished', 'true');
    }
  } else {
    showMessage('答案不对，再想想～','error');
    // 输入框抖动
    el.answerInput.classList.add('shake');
    setTimeout(() => el.answerInput.classList.remove('shake'), 400);
  }
}

function showMessage(text, type){
  el.message.classList.remove('hidden');
  el.message.style.background = type === 'success' ? '#fff0f5' : '#fff5f7';
  el.message.style.border = type === 'success' ? '1px solid #f5a9c1' : '1px solid #f3b0b0';
  el.message.style.color = type === 'success' ? '#a1104d' : '#9a1b1b';
  el.message.innerHTML = text;
}

// 播放/暂停音乐（首页）
el.musicBtn.addEventListener('click', () => {
  if(el.bgm.paused){
    el.bgm.play();
    el.musicBtn.textContent = "暂停音乐 ⏸️";
    el.musicBtnGame.textContent = "暂停音乐 ⏸️";
  } else {
    el.bgm.pause();
    el.musicBtn.textContent = "播放音乐 🎶";
    el.musicBtnGame.textContent = "播放音乐 🎶";
  }
});
// 播放/暂停音乐（游戏页）
el.musicBtnGame.addEventListener('click', () => {
  if(el.bgm.paused){
    el.bgm.play();
    el.musicBtn.textContent = "暂停音乐 ⏸️";
    el.musicBtnGame.textContent = "暂停音乐 ⏸️";
  } else {
    el.bgm.pause();
    el.musicBtn.textContent = "播放音乐 🎶";
    el.musicBtnGame.textContent = "播放音乐 🎶";
  }
});

// 开始游戏
el.startBtn.addEventListener('click', () => {
  el.intro.classList.add('hidden');
  el.gameCard.classList.remove('hidden');
  loadNode(1); // 从第一关开始
});

el.submitBtn.addEventListener('click', checkAnswer);
el.hintBtn.addEventListener('click', () => {
  el.hintBox.classList.toggle('hidden');
});
el.answerInput.addEventListener('keydown', e => { if(e.key === 'Enter'){ checkAnswer(); } });

document.addEventListener('DOMContentLoaded', () => {
  if(localStorage.getItem('puzzle_finished') === 'true'){
    currentNodeId = nodes.length;
    loadNode(currentNodeId);
    showMessage('你已经完成啦 💖 如果想重新开始，点击下方按钮','success');
    const resetBtn = document.createElement('button');
    resetBtn.className = 'btn secondary';
    resetBtn.textContent = '重置进度';
    resetBtn.onclick = () => {
      localStorage.removeItem('puzzle_current_node');
      localStorage.removeItem('puzzle_finished');
      currentNodeId = 1;
      loadNode(1);
      el.message.classList.add('hidden');
    };
    el.nextArea.appendChild(resetBtn);
  }
});
</script>
</body>
</html>
