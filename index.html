<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>七夕特别礼物 💝</title>
<style>
  body {
    font-family: "Helvetica Neue", Arial, sans-serif;
    background: linear-gradient(135deg, #ffe6eb, #fff0f5);
    margin: 0; padding: 0;
  }
  .card {
    max-width: 760px;
    margin: 40px auto;
    padding: 22px;
    background: #fff;
    border-radius: 18px;
    box-shadow: 0 8px 24px rgba(255, 120, 160, 0.25);
    position: relative;
    text-align: center;
  }
  h1 {
    margin: 0 0 16px;
    font-size: 28px;
    color: #e25590;
  }
  p {
    color: #555;
    line-height: 1.6;
  }
  .btn {
    display: inline-block;
    margin-top: 18px;
    padding: 12px 20px;
    border-radius: 10px;
    background: #ff7aa2;
    color: #fff;
    border: none;
    cursor: pointer;
    transition: background 0.2s, transform 0.2s;
    font-size: 16px;
  }
  .btn:hover {
    background: #ff5a8c;
    transform: scale(1.05);
  }
  .btn.secondary {
    background: #ffe4ec;
    color: #d6336c;
    border: 1px solid #f9b5d1;
  }
  .hearts {
    font-size: 28px;
    animation: float 3s infinite;
    margin: 12px 0;
  }
  @keyframes float {
    0% { transform: translateY(0); opacity: 1; }
    50% { transform: translateY(-15px); opacity: 0.7; }
    100% { transform: translateY(-30px); opacity: 0; }
  }
  .music-control {
    margin-top: 16px;
  }
  .hidden { display: none; }
  footer { margin-top: 18px; font-size: 13px; color: #888; text-align: center; }
</style>
</head>
<body>
  <!-- 开场页面 -->
  <div id="intro" class="card">
    <div class="hearts">💖✨💝</div>
    <h1>七夕特别的礼物</h1>
    <p id="introText">
      亲爱的，今天是属于我们的七夕节 💕<br/>
      这里有一份我为你准备的小小解谜礼物 🎁<br/>
      每一道题目，都是我们故事的一部分 ✨<br/>
      希望你能带着笑容，一步步走向最终的惊喜 💌
    </p>
    <div class="music-control">
      <button id="musicBtn" class="btn secondary">播放音乐 🎶</button>
    </div>
    <button id="startBtn" class="btn">开始冒险 ➡️</button>
  </div>

  <!-- 游戏页面 -->
  <div id="gameCard" class="card hidden">
    <h1>七夕解谜小冒险</h1>
    <div id="game">
      <div class="prompt" id="promptTxt"></div>
      <input id="answerInput" type="text" placeholder="输入答案..." autocomplete="off" />
      <div>
        <button id="submitBtn" class="btn">提交答案</button>
        <button id="hintBtn" class="btn secondary">小提示 💌</button>
      </div>

      <div id="hintBox" class="hidden" style="margin-top:12px; padding:10px; background:#fff8f9; border-left:4px solid #ffb3c1; border-radius:6px;"></div>
      <div id="message" class="hidden" style="margin-top:12px; padding:10px; border-radius:6px;"></div>
      <div id="nextArea" style="margin-top:12px;"></div>
      <div id="progress" style="margin-top:10px; font-size:13px; color:#888;"></div>
    </div>
    <footer>Happy 七夕 ❤️ 爱在解谜的每一步。</footer>
  </div>

  <!-- 背景音乐 -->
  <audio id="bgm" loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
  </audio>

<script>
const nodes = [
  {
    id: 1,
    prompt: "第一关 💕：在我们的合照里，你最喜欢的那个笑容对应的月份，就是密码（输入月份数字）。",
    answer: "8",
    hint: "七夕在八月哦～",
    successText: "太棒了！💖 继续前往下一关，更多的回忆在等你～"
  },
  {
    id: 2,
    prompt: "第二关 🌙：还记得第一次一起看电影吗？那部电影的第一个字母（大写）就是密码。",
    answer: "L",
    hint: "答案在我们第一次电影院的票根里～",
    successText: "好浪漫！💌 继续前进吧。"
  },
  {
    id: 3,
    prompt: "最后一关 🌹：输入你对我常说的三个字（拼音大写）。",
    answer: "WOAI NI",
    hint: "三个字，是你每天挂在嘴边的～",
    successText: "恭喜通关！🎉 七夕快乐，我爱你 ❤️ 礼物在等你 👉 <strong>https://example.com/yourgift</strong>"
  }
];

let currentNodeId = parseInt(localStorage.getItem('puzzle_current_node') || '1', 10);
const el = {
  intro: document.getElementById('intro'),
  startBtn: document.getElementById('startBtn'),
  gameCard: document.getElementById('gameCard'),
  promptTxt: document.getElementById('promptTxt'),
  answerInput: document.getElementById('answerInput'),
  submitBtn: document.getElementById('submitBtn'),
  hintBtn: document.getElementById('hintBtn'),
  hintBox: document.getElementById('hintBox'),
  message: document.getElementById('message'),
  nextArea: document.getElementById('nextArea'),
  progress: document.getElementById('progress'),
  musicBtn: document.getElementById('musicBtn'),
  bgm: document.getElementById('bgm')
};

function findNode(id){ return nodes.find(n => n.id === id); }
function renderProgress(){ el.progress.textContent = `进度：第 ${currentNodeId} / ${nodes.length} 步`; }

function loadNode(id){
  const node = findNode(id);
  if(!node) return;
  currentNodeId = node.id;
  localStorage.setItem('puzzle_current_node', String(currentNodeId));
  el.promptTxt.innerText = node.prompt;
  el.hintBox.classList.add('hidden');
  el.hintBox.innerText = node.hint;
  el.message.classList.add('hidden');
  el.answerInput.value = "";
  el.answerInput.focus();
  el.nextArea.innerHTML = "";
  renderProgress();
}

function checkAnswer(){
  const node = findNode(currentNodeId);
  const raw = el.answerInput.value.trim();
  if(!raw){ showMessage('请输入答案再提交哦～','error'); return; }
  const input = raw.toUpperCase();
  if(input === node.answer.toUpperCase()){
    showMessage(node.successText,'success');
    const nextNode = findNode(currentNodeId + 1);
    if(nextNode){
      const btn = document.createElement('button');
      btn.className = 'btn';
      btn.innerText = '进入下一关 ➡️';
      btn.onclick = ()
